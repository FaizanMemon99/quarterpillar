{"version":3,"names":["React","useCallback","useEffect","useImperativeHandle","useState","View","Text","styles","BackgroundTimer","defaulProps","style","textStyle","onTimes","_seconds","onPause","onEnd","interval","hours","minute","seconds","currentSeconds","TimerComponent","forwardRef","props","ref","initialSeconds","fontFamily","autoStart","formatTime","key","setKey","Math","random","start","pause","resume","stop","timer","setInterval","initTime","iSeconds","times","init","clear","clearInterval","font","renderTimer","text","toString","length","defaultProps"],"sources":["index.tsx"],"sourcesContent":["/* eslint-disable no-bitwise */\nimport React, {\n  useCallback,\n  useEffect,\n  useImperativeHandle,\n  useState,\n} from 'react';\nimport { View, Text } from 'react-native';\nimport { styles } from './styles';\nimport type { TimerProps } from './model';\nimport BackgroundTimer from 'react-native-background-timer';\n\nconst defaulProps = {\n  style: {},\n  textStyle: {},\n  onTimes: (_seconds: number) => {},\n  onPause: (_seconds: number) => {},\n  onEnd: (_seconds: number) => {},\n};\n\nlet interval: any = null;\nlet hours = 0;\nlet minute = 0;\nlet seconds = 0;\nlet currentSeconds = 0;\n\nconst TimerComponent = React.forwardRef<any, TimerProps>((props, ref) => {\n  const {\n    initialSeconds = 0,\n    style,\n    textStyle,\n    fontFamily,\n    autoStart = false,\n    formatTime = 'hh:mm:ss',\n    onEnd,\n    onTimes,\n    onPause,\n  } = props;\n  const [key, setKey] = useState(Math.random());\n\n  useImperativeHandle(ref, () => {\n    return { start, pause, resume, stop };\n  });\n\n  const timer = useCallback(() => {\n    interval = BackgroundTimer.setInterval(() => {\n      currentSeconds = currentSeconds + 1;\n      if (seconds < 60) {\n        seconds = seconds + 1;\n      } else {\n        seconds = 0;\n        minute = minute + 1;\n      }\n      if (minute === 60) {\n        minute = 0;\n        hours = hours + 1;\n      }\n      if (onTimes) {\n        onTimes(currentSeconds);\n      }\n      setKey(Math.random());\n    }, 1000);\n  }, [onTimes]);\n\n  const initTime = useCallback((iSeconds: number) => {\n    if (iSeconds >= 3600) {\n      hours = ~~(iSeconds / 3600);\n      const times = iSeconds % 3600;\n      initTime(times);\n    } else {\n      if (iSeconds >= 60) {\n        minute = ~~(iSeconds / 60);\n        const times = iSeconds % 60;\n        initTime(times);\n      } else {\n        seconds = iSeconds;\n      }\n    }\n  }, []);\n\n  const init = useCallback(() => {\n    currentSeconds = 0;\n    hours = 0;\n    minute = 0;\n    seconds = 0;\n    if (initialSeconds > 0) {\n      initTime(initialSeconds);\n    }\n    clear();\n    setKey(Math.random());\n  }, [initTime, initialSeconds]);\n\n  const start = useCallback(() => {\n    init();\n\n    if (!interval) {\n      timer();\n    }\n  }, [init, timer]);\n\n  const pause = useCallback(() => {\n    clear();\n    if (onPause) {\n      onPause(currentSeconds);\n    }\n  }, [onPause]);\n\n  const resume = () => {\n    if (!interval) {\n      timer();\n    }\n  };\n\n  const stop = () => {\n    if (onEnd) {\n      onEnd(currentSeconds);\n    }\n\n    init();\n    setKey(Math.random());\n    clear();\n  };\n\n  const clear = () => {\n    if (interval) {\n      BackgroundTimer.clearInterval(interval);\n      interval = null;\n    }\n  };\n\n  useEffect(() => {\n    return () => {\n      pause();\n      init();\n      setKey(Math.random());\n    };\n  }, [init, pause]);\n\n  useEffect(() => {\n    if (initialSeconds > 0) {\n      init();\n    }\n    setKey(Math.random());\n  }, [init, initialSeconds]);\n\n  useEffect(() => {\n    if (autoStart) {\n      start();\n    }\n  }, [autoStart, initialSeconds, start]);\n\n  const font = () => {\n    if (fontFamily) {\n      return {\n        fontFamily: fontFamily,\n      };\n    } else {\n      return {};\n    }\n  };\n\n  const renderTimer = () => {\n    if (formatTime === 'hh:mm:ss') {\n      if (hours > 0) {\n        return (\n          <Text style={[styles.text, textStyle, font()]}>{`${hours}:${\n            minute.toString().length === 1 ? '0' : ''\n          }${minute}:${\n            seconds.toString().length === 1 ? '0' : ''\n          }${seconds}`}</Text>\n        );\n      } else {\n        if (minute > 0) {\n          return (\n            <Text style={[styles.text, textStyle, font()]}>{`${minute}:${\n              seconds.toString().length === 1 ? '0' : ''\n            }${seconds}`}</Text>\n          );\n        } else {\n          return (\n            <Text style={[styles.text, textStyle, font()]}>{`${seconds}`}</Text>\n          );\n        }\n      }\n    } else {\n      return (\n        <Text\n          style={[styles.text, textStyle, font()]}\n        >{`${currentSeconds}`}</Text>\n      );\n    }\n  };\n\n  return (\n    <View style={style} key={key}>\n      {renderTimer()}\n    </View>\n  );\n});\n\nTimerComponent.defaultProps = defaulProps;\n\nexport default TimerComponent;\n"],"mappings":"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"}