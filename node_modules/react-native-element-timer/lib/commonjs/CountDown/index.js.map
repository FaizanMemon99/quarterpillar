{"version":3,"names":["defaulProps","style","textStyle","onTimes","_seconds","onPause","onEnd","interval","hours","minute","seconds","currentSeconds","CountdownComponent","React","forwardRef","props","ref","initialSeconds","fontFamily","autoStart","formatTime","key","setKey","useState","Math","random","useImperativeHandle","start","pause","resume","stop","init","useCallback","clear","timer","useEffect","BackgroundTimer","setInterval","clearInterval","font","renderTimer","styles","text","toString","length","defaultProps"],"sources":["index.tsx"],"sourcesContent":["/* eslint-disable no-bitwise */\nimport React, {\n  useCallback,\n  useEffect,\n  useImperativeHandle,\n  useState,\n} from 'react';\nimport { View, Text } from 'react-native';\nimport { styles } from './styles';\nimport type { CountDownProps } from './model';\nimport BackgroundTimer from 'react-native-background-timer';\n\nconst defaulProps = {\n  style: {},\n  textStyle: {},\n  onTimes: (_seconds: number) => {},\n  onPause: (_seconds: number) => {},\n  onEnd: (_seconds: number) => {},\n};\n\nlet interval: any = null;\nlet hours = 0;\nlet minute = 0;\nlet seconds = 0;\nlet currentSeconds = 0;\n\nconst CountdownComponent = React.forwardRef<any, CountDownProps>(\n  (props, ref) => {\n    const {\n      initialSeconds,\n      style,\n      textStyle,\n      fontFamily,\n      autoStart = false,\n      formatTime = 'hh:mm:ss',\n      onEnd,\n      onTimes,\n      onPause,\n    } = props;\n    const [key, setKey] = useState(Math.random());\n\n    useImperativeHandle(ref, () => {\n      return { start, pause, resume, stop };\n    });\n\n    const init = useCallback(() => {\n      if (initialSeconds) {\n        currentSeconds = initialSeconds;\n        hours = ~~(currentSeconds / 3600);\n        minute = ~~((currentSeconds % 3600) / 60);\n        seconds = ~~currentSeconds % 60;\n      }\n      clear();\n      setKey(Math.random());\n    }, [initialSeconds]);\n\n    const pause = useCallback(() => {\n      if (onPause) {\n        onPause(currentSeconds);\n      }\n      clear();\n    }, [onPause]);\n\n    const resume = () => {\n      if (!interval) {\n        timer();\n      }\n    };\n\n    const stop = () => {\n      if (onEnd) {\n        onEnd(currentSeconds);\n      }\n\n      init();\n      clear();\n    };\n\n    useEffect(() => {\n      return () => {\n        pause();\n        init();\n      };\n    }, [init, pause]);\n\n    useEffect(() => {\n      init();\n    }, [init, initialSeconds]);\n\n    const timer = useCallback(() => {\n      interval = BackgroundTimer.setInterval(() => {\n        if (currentSeconds > 0) {\n          currentSeconds = currentSeconds - 1;\n          hours = ~~(currentSeconds / 3600);\n          minute = ~~((currentSeconds % 3600) / 60);\n          seconds = ~~currentSeconds % 60;\n\n          if (onTimes) {\n            onTimes(currentSeconds);\n          }\n        }\n        if (currentSeconds <= 0) {\n          if (onEnd) {\n            onEnd(currentSeconds);\n          }\n          clear();\n        }\n        setKey(Math.random());\n      }, 1000);\n    }, [onEnd, onTimes]);\n\n    const start = useCallback(() => {\n      init();\n\n      if (!interval) {\n        timer();\n      }\n    }, [init, timer]);\n\n    useEffect(() => {\n      if (autoStart) {\n        start();\n      }\n    }, [autoStart, initialSeconds, start]);\n\n    const clear = () => {\n      if (interval) {\n        BackgroundTimer.clearInterval(interval);\n        interval = null;\n      }\n    };\n\n    const font = () => {\n      if (fontFamily) {\n        return {\n          fontFamily: fontFamily,\n        };\n      } else {\n        return {};\n      }\n    };\n\n    const renderTimer = () => {\n      if (formatTime === 'hh:mm:ss') {\n        if (hours > 0) {\n          return (\n            <Text style={[styles.text, textStyle, font()]}>{`${hours}:${\n              minute.toString().length === 1 ? '0' : ''\n            }${minute}:${\n              seconds.toString().length === 1 ? '0' : ''\n            }${seconds}`}</Text>\n          );\n        } else {\n          if (minute > 0) {\n            return (\n              <Text style={[styles.text, textStyle, font()]}>{`${minute}:${\n                seconds.toString().length === 1 ? '0' : ''\n              }${seconds}`}</Text>\n            );\n          } else {\n            return (\n              <Text\n                style={[styles.text, textStyle, font()]}\n              >{`${seconds}`}</Text>\n            );\n          }\n        }\n      } else {\n        return (\n          <Text\n            style={[styles.text, textStyle, font()]}\n          >{`${currentSeconds}`}</Text>\n        );\n      }\n    };\n\n    return (\n      <View style={style} key={key}>\n        {renderTimer()}\n      </View>\n    );\n  }\n);\n\nCountdownComponent.defaultProps = defaulProps;\n\nexport default CountdownComponent;\n"],"mappings":";;;;;;;AACA;;AAMA;;AACA;;AAEA;;;;;;;;AAVA;AAYA,MAAMA,WAAW,GAAG;EAClBC,KAAK,EAAE,EADW;EAElBC,SAAS,EAAE,EAFO;EAGlBC,OAAO,EAAGC,QAAD,IAAsB,CAAE,CAHf;EAIlBC,OAAO,EAAGD,QAAD,IAAsB,CAAE,CAJf;EAKlBE,KAAK,EAAGF,QAAD,IAAsB,CAAE;AALb,CAApB;AAQA,IAAIG,QAAa,GAAG,IAApB;AACA,IAAIC,KAAK,GAAG,CAAZ;AACA,IAAIC,MAAM,GAAG,CAAb;AACA,IAAIC,OAAO,GAAG,CAAd;AACA,IAAIC,cAAc,GAAG,CAArB;;AAEA,MAAMC,kBAAkB,gBAAGC,cAAA,CAAMC,UAAN,CACzB,CAACC,KAAD,EAAQC,GAAR,KAAgB;EACd,MAAM;IACJC,cADI;IAEJhB,KAFI;IAGJC,SAHI;IAIJgB,UAJI;IAKJC,SAAS,GAAG,KALR;IAMJC,UAAU,GAAG,UANT;IAOJd,KAPI;IAQJH,OARI;IASJE;EATI,IAUFU,KAVJ;EAWA,MAAM,CAACM,GAAD,EAAMC,MAAN,IAAgB,IAAAC,eAAA,EAASC,IAAI,CAACC,MAAL,EAAT,CAAtB;EAEA,IAAAC,0BAAA,EAAoBV,GAApB,EAAyB,MAAM;IAC7B,OAAO;MAAEW,KAAF;MAASC,KAAT;MAAgBC,MAAhB;MAAwBC;IAAxB,CAAP;EACD,CAFD;EAIA,MAAMC,IAAI,GAAG,IAAAC,kBAAA,EAAY,MAAM;IAC7B,IAAIf,cAAJ,EAAoB;MAClBN,cAAc,GAAGM,cAAjB;MACAT,KAAK,GAAG,CAAC,EAAEG,cAAc,GAAG,IAAnB,CAAT;MACAF,MAAM,GAAG,CAAC,EAAGE,cAAc,GAAG,IAAlB,GAA0B,EAA5B,CAAV;MACAD,OAAO,GAAG,CAAC,CAACC,cAAF,GAAmB,EAA7B;IACD;;IACDsB,KAAK;IACLX,MAAM,CAACE,IAAI,CAACC,MAAL,EAAD,CAAN;EACD,CATY,EASV,CAACR,cAAD,CATU,CAAb;EAWA,MAAMW,KAAK,GAAG,IAAAI,kBAAA,EAAY,MAAM;IAC9B,IAAI3B,OAAJ,EAAa;MACXA,OAAO,CAACM,cAAD,CAAP;IACD;;IACDsB,KAAK;EACN,CALa,EAKX,CAAC5B,OAAD,CALW,CAAd;;EAOA,MAAMwB,MAAM,GAAG,MAAM;IACnB,IAAI,CAACtB,QAAL,EAAe;MACb2B,KAAK;IACN;EACF,CAJD;;EAMA,MAAMJ,IAAI,GAAG,MAAM;IACjB,IAAIxB,KAAJ,EAAW;MACTA,KAAK,CAACK,cAAD,CAAL;IACD;;IAEDoB,IAAI;IACJE,KAAK;EACN,CAPD;;EASA,IAAAE,gBAAA,EAAU,MAAM;IACd,OAAO,MAAM;MACXP,KAAK;MACLG,IAAI;IACL,CAHD;EAID,CALD,EAKG,CAACA,IAAD,EAAOH,KAAP,CALH;EAOA,IAAAO,gBAAA,EAAU,MAAM;IACdJ,IAAI;EACL,CAFD,EAEG,CAACA,IAAD,EAAOd,cAAP,CAFH;EAIA,MAAMiB,KAAK,GAAG,IAAAF,kBAAA,EAAY,MAAM;IAC9BzB,QAAQ,GAAG6B,mCAAA,CAAgBC,WAAhB,CAA4B,MAAM;MAC3C,IAAI1B,cAAc,GAAG,CAArB,EAAwB;QACtBA,cAAc,GAAGA,cAAc,GAAG,CAAlC;QACAH,KAAK,GAAG,CAAC,EAAEG,cAAc,GAAG,IAAnB,CAAT;QACAF,MAAM,GAAG,CAAC,EAAGE,cAAc,GAAG,IAAlB,GAA0B,EAA5B,CAAV;QACAD,OAAO,GAAG,CAAC,CAACC,cAAF,GAAmB,EAA7B;;QAEA,IAAIR,OAAJ,EAAa;UACXA,OAAO,CAACQ,cAAD,CAAP;QACD;MACF;;MACD,IAAIA,cAAc,IAAI,CAAtB,EAAyB;QACvB,IAAIL,KAAJ,EAAW;UACTA,KAAK,CAACK,cAAD,CAAL;QACD;;QACDsB,KAAK;MACN;;MACDX,MAAM,CAACE,IAAI,CAACC,MAAL,EAAD,CAAN;IACD,CAlBU,EAkBR,IAlBQ,CAAX;EAmBD,CApBa,EAoBX,CAACnB,KAAD,EAAQH,OAAR,CApBW,CAAd;EAsBA,MAAMwB,KAAK,GAAG,IAAAK,kBAAA,EAAY,MAAM;IAC9BD,IAAI;;IAEJ,IAAI,CAACxB,QAAL,EAAe;MACb2B,KAAK;IACN;EACF,CANa,EAMX,CAACH,IAAD,EAAOG,KAAP,CANW,CAAd;EAQA,IAAAC,gBAAA,EAAU,MAAM;IACd,IAAIhB,SAAJ,EAAe;MACbQ,KAAK;IACN;EACF,CAJD,EAIG,CAACR,SAAD,EAAYF,cAAZ,EAA4BU,KAA5B,CAJH;;EAMA,MAAMM,KAAK,GAAG,MAAM;IAClB,IAAI1B,QAAJ,EAAc;MACZ6B,mCAAA,CAAgBE,aAAhB,CAA8B/B,QAA9B;;MACAA,QAAQ,GAAG,IAAX;IACD;EACF,CALD;;EAOA,MAAMgC,IAAI,GAAG,MAAM;IACjB,IAAIrB,UAAJ,EAAgB;MACd,OAAO;QACLA,UAAU,EAAEA;MADP,CAAP;IAGD,CAJD,MAIO;MACL,OAAO,EAAP;IACD;EACF,CARD;;EAUA,MAAMsB,WAAW,GAAG,MAAM;IACxB,IAAIpB,UAAU,KAAK,UAAnB,EAA+B;MAC7B,IAAIZ,KAAK,GAAG,CAAZ,EAAe;QACb,oBACE,6BAAC,iBAAD;UAAM,KAAK,EAAE,CAACiC,cAAA,CAAOC,IAAR,EAAcxC,SAAd,EAAyBqC,IAAI,EAA7B;QAAb,GAAiD,GAAE/B,KAAM,IACvDC,MAAM,CAACkC,QAAP,GAAkBC,MAAlB,KAA6B,CAA7B,GAAiC,GAAjC,GAAuC,EACxC,GAAEnC,MAAO,IACRC,OAAO,CAACiC,QAAR,GAAmBC,MAAnB,KAA8B,CAA9B,GAAkC,GAAlC,GAAwC,EACzC,GAAElC,OAAQ,EAJX,CADF;MAOD,CARD,MAQO;QACL,IAAID,MAAM,GAAG,CAAb,EAAgB;UACd,oBACE,6BAAC,iBAAD;YAAM,KAAK,EAAE,CAACgC,cAAA,CAAOC,IAAR,EAAcxC,SAAd,EAAyBqC,IAAI,EAA7B;UAAb,GAAiD,GAAE9B,MAAO,IACxDC,OAAO,CAACiC,QAAR,GAAmBC,MAAnB,KAA8B,CAA9B,GAAkC,GAAlC,GAAwC,EACzC,GAAElC,OAAQ,EAFX,CADF;QAKD,CAND,MAMO;UACL,oBACE,6BAAC,iBAAD;YACE,KAAK,EAAE,CAAC+B,cAAA,CAAOC,IAAR,EAAcxC,SAAd,EAAyBqC,IAAI,EAA7B;UADT,GAEG,GAAE7B,OAAQ,EAFb,CADF;QAKD;MACF;IACF,CAxBD,MAwBO;MACL,oBACE,6BAAC,iBAAD;QACE,KAAK,EAAE,CAAC+B,cAAA,CAAOC,IAAR,EAAcxC,SAAd,EAAyBqC,IAAI,EAA7B;MADT,GAEG,GAAE5B,cAAe,EAFpB,CADF;IAKD;EACF,CAhCD;;EAkCA,oBACE,6BAAC,iBAAD;IAAM,KAAK,EAAEV,KAAb;IAAoB,GAAG,EAAEoB;EAAzB,GACGmB,WAAW,EADd,CADF;AAKD,CA3JwB,CAA3B;;AA8JA5B,kBAAkB,CAACiC,YAAnB,GAAkC7C,WAAlC;eAEeY,kB"}